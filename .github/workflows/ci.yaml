name: CI Docker Hub

on:
  push:
    branches:
      - main

jobs:
  build-and-push:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Log in to Docker Hub
      uses: docker/login-action@v2
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}

    - name: Build and push service1
      run: |
        docker build -t carlostapiao/service1:latest ./service1
        docker push carlostapiao/service1:latest

    - name: Build and push service2
      run: |
        docker build -t carlostapiao/service2:latest ./service2
        docker push carlostapiao/service2:latest

    - name: Build and push service3
      run: |
        docker build -t carlostapiao/service3:latest ./service3
        docker push carlostapiao/service3:latest